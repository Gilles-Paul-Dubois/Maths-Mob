<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Décomposition LU</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="../../css/themes/myown.css" />
    <link rel="stylesheet" href="../../css/themes/jquery.mobile.icons.min.css" />
    <link rel="stylesheet" href="../../css/jquery.mobile.structure-1.4.5.min.css" />
    <link href="../../css/myown.css" rel="stylesheet">
    <script src="../../js/jquery-1.11.3.js"></script>
    <script src="../../js/jquery.mobile-1.4.5.min.js"></script>
    <script src="../../js/custom.js"></script>
    <script src="../../mathjax/tex-chtml.js" id="MathJax-script" async></script>
  </head>
  <body style="overflow: auto; " class="fr">
    <script>
      window.onload = get();
    </script>
    <a name="beg"></a>
    <div data-role="page" data-theme="d">
      <div data-role="header">
        <table>
          <tr>
            <td>Choisissez votre langue !</td>
            <td>
              <button class="ui-btn ui-btn-inline" onclick="changelang('fr')">
                <img src="../../images/fr.png" width="64" height="32" alt="Français">
              </button>
            </td>
            <td>Choose your language !</td>
            <td>
              <button class="ui-btn ui-btn-inline" onclick="changelang('en')">
                <img src="../../images/uk.png" width="64" height="32" alt="English">
              </button>
            </td>
          </tr>
        </table>
      </div>
      <!-- /header -->
      <div style="overflow: auto; " data-role="content" data-theme="d">
        <div lang="fr">
          <div>
            <ul style=list-style-type:'';>
              <li>
                <input type="button" value="Exercices" onclick="go('exercices/lu/menu.html')" />
              </li>
              <li>
                <input type="button" value="Retour au menu 'Systèmes linéaires'" onclick="go('index.html')" />
              </li>
              <li>
                <input type="button" value="Retour au menu 'Algèbre linéaire'" onclick="go('../index.html')" />
              </li>
              <li>
                <input type="button" value="Retour à l'accueil" onclick="go('../../index.html')" />
              </li>
            </ul>
          </div>
          <!-- /navbar -->
        </div>
        <!-- /fr -->
        <div lang="en">
          <div>
            <ul style=list-style-type:'';>
              <li>
                <input type="button" value="Exercises" onclick="go('exercices/lu/menu.html')" />
              </li>
              <li>
                <input type="button" value="Back to 'Linear systems'" onclick="go('index.html')" />
              </li>
              <li>
                <input type="button" value="Back to Linear Algebra" onclick="go('../index.html')" />
              </li>
              <li>
                <input type="button" value="Back to home page" onclick="go('../../index.html')" />
              </li>
            </ul>
          </div>
          <!-- /navbar -->
        </div>
        <!-- /en -->
        <div lang="fr">
          <h2> Terminologie </h2> Nous vous invitons maintenant à revoir la terminologie concernant les <input type="button" value="matrices triangulaires" onclick="go('../matrices/mattri.html#')" data-inline="true" />.
        </div>
        <!-- /fr -->
        <div lang="en">
          <h2> Terminology </h2> We now invite you to review the terminology concerning the <input data-inline="true" onclick="go('../matrices/mattri.html#')" type="button" value=" triangular matrices" />.
        </div>
        <!-- /en -->
        <!-- STOP -->
        <a name="def1"></a>
        <div id="container">
          <div lang="fr">
            <div id="label">définition 1</div> Nous appelerons <b>
              <i> 'décomposition LU' </i>
            </b> de A toute écriture de A sous la forme d'un produit A=LU où: <ul>
              <li> L est une matrice triangulaire inférieure. </li>
              <li> U est une matrice triangulaire supérieure. </li>
            </ul>
          </div>
          <!--/fr-->
          <div lang="en">
            <div id="label">definition 1</div> We will call <b>
              <i> 'LU decomposition' </i>
            </b> of A any writing of A in the form of a product A=LU where: <ul>
              <li> L is a lower triangular matrix. </li>
              <li> U is an upper triangular matrix. </li>
            </ul>
          </div>
          <!-- /en -->
        </div>
        <!-- /cont -->
        <!-- /STOP -->
        <div lang="fr"> Essayons maintenant de voir l'intérêt d'une telle décomposition dans le cas où A est la matrice d'un <input type="button" value="système de Cramer" onclick="go('cramer.html#')" data-inline="true" />. <br /> Les systèmes triangulaires se résolvent instantanément. <ul>
            <li> Par récurrence ascendante dans le cas des matrices de type L. </li>
            <li> Par récurrence descendante dans le cas des matrices de type U. </li>
          </ul> Supposons maintenant A ainsi décomposée. <br /> Le système AX=B s'écrit LUX=B <br /> Posons UX=Y <br /> Alors on a LY=B, donc Y est solution d'un système triangulaire inférieur. <br /> Y étant connu X est solution d'un système triangulaire supérieur dont Y est second membre. <br /> La résolution de AX=B se ramène donc à la résolution de deux systèmes triangulaires successifs. <br /> La factorisation de type LU est donc une méthode de résolution. Elle semble a priori plus complexe que la <input type="button" value="méthode du pivot de Gauss" onclick="go('gauss.html#')" data-inline="true" />, mais elle a cependant un intérêt indéniable. <br /> Dans la méthode de Gauss, si on change le second membre B, tous les calculs sont à refaire. Si A est décomposée, la méthode de résolution ne dépend plus de B (mais les résultats en dépendent...). <br /> On préfèrera donc une méthode par décomposition, chaque fois qu'on a à résoudre plusieurs systèmes avec la même matrice et des seconds membres distincts. <br /> Il existe plusieurs algorithmes de décomposition LU. <br /> La résolution est encore facilitée quand une des deux matrices triangulaires possède uniquement des 1 sur la diagonale. <br /> Nous présenterons ici la méthode dite <strong>
            <em> 'de Crout' </em>
          </strong> , pour laquelle les éléments diagonaux de U sont tous égaux à 1. <br /> Posons: <br /> A= (α<sub>i,j</sub>)<sub>1≤i,j≤n</sub>
          <br /> L= (l<sub>i,j</sub>)<sub>1≤i,j≤n</sub>
          <br /> U= (u<sub>i,j</sub>)<sub>1≤i,j≤n</sub>
          <br /> Posant A=LU en égalant les coefficients, il vient des relations de récurrence:
        </div>
        <!-- /fr -->
        <div lang="en"> Let us now try to see the interest of such a decomposition in the case where A is the matrix of a <input data-inline="true" onclick="go('cramer.html#')" type="button" value=" Cramer system" />. <br /> Triangular systems resolve instantly. <ul>
            <li> By ascending induction in the case of L-type matrices. </li>
            <li> By downward induction in the case of U-type matrices. </li>
          </ul> Now suppose A thus decomposed. <br /> The system AX=B is written LUX=B <br /> Let UX=Y <br /> Then we have LY=B, so Y is the solution of a lower triangular system. <br /> Y being known X is solution of an upper triangular system of which Y is second member. <br /> The resolution of AX=B is therefore reduced to the resolution of two successive triangular systems. <br />LU type factorization is therefore a solution method. It seems a priori more complex than the <input data-inline="true" onclick="go('gauss.html#')" type="button" value="Gaussian pivot method" />, but it nevertheless has an undeniable interest. <br />In the method of Gauss, if we change the second member B, all the calculations have to be redone. If A is decomposed, the solution method no longer depends on B (but the results depend on it...). <br />We will therefore prefer a method by decomposition, each time we have to solve several systems with the same matrix and distinct second members. <br /> There are several LU decomposition algorithms. <br /> Solving is further facilitated when one of the two triangular matrices has only 1s on the diagonal. <br />We present here the method called <strong>
            <em> 'Crout' </em>
          </strong> , for which the diagonal elements of U are all equal to 1. <br /> Let's say: <br /> A= (α<sub>i,j</sub>)<sub>1≤i,j≤n</sub>
          <br /> L= (l<sub>i,j</sub>)<sub>1≤i,j≤n</sub>
          <br /> U= (u<sub>i,j</sub>)<sub>1≤i,j≤n</sub>
          <br /> Posing A=LU by equalizing the coefficients, it comes from the recurrence relations:
        </div>
        <!-- /en -->
        <!-- FORMULE UNIV INLINE -->
        <p>\( l_{i,j}=a_{i,j}-\sum_{k=1}^{i_1}l_{i,k}u_{k,j} \)</p>
        <!-- /FORMULE UNIV INLINE-->
        <div lang="fr"> où i &ge; j </div>
        <!-- /fr -->
        <div lang="en"> where i ≥ j </div>
        <!-- /en -->
        <!-- FORMULE UNIV INLINE -->
        <p>\( u_{i,j}=\frac{1}{l_{i,i}}\left ( a_{i,j}-\sum_{k=1}^{i-1}l_{i,k}u_{k,j} \right ) \)</p>
        <!-- /FORMULE UNIV INLINE-->
        <div lang="fr"> où i &lt; j <br> Le principal problème vient du fait que les calculs sont impossibles si on est dans le cas où l<sub>k,k</sub>=0. Il faut alors procéder à un 'pivotage', c'est à dire effectuer une même transposition sur les lignes de L et les lignes de A de façon à amener en première position une ligne de L avec l<sub>k,k</sub>≠0. Il est facile de vérifier que si A est inversible on peut toujours trouver un tel pivot. Cette fois encore on peut optimiser en choisissant le meilleur parmi les possibles. <br> Il existe d'autres méthodes en particulier celle dite <strong>
            <em> 'de Doolittle' </em>
          </strong> pour laquelle ce sont les éléments diagonaux de L qui sont égaux à 1. Nous ne jugeons pas utile de développer cet algorithme ici, les manipulations sur les lignes étant simplement remplacées par des manipulations sur les colonnes. <br> Voici maintenant une appliquette qui vous permettra de visualiser des factorisations LU pour des matrices d'ordre 4 à coefficients réels. <br> P désigne la matrice permutante de pivotage. </div>
        <!-- /fr -->
        <div lang="en"> where i
          < j <br />The main problem comes from the fact that the calculations are impossible if we are in the case where the l<sub>k,k</sub>=0. It is then necessary to carry out a 'pivoting', that is to say to carry out a same transposition on the lines of L and the lines of A so as to bring to first position a row of L with l<sub>k,k</sub>≠0. He is easy to check that if A is invertible we can always find such a pivot. This time again we can optimize by choosing the best of the possible. <br />There are other methods, in particular the one called <strong>
            <em> 'Doolittle' </em>
          </strong> for which it is the diagonal elements of L which are equal to 1. We do not consider it useful to develop this algorithm here, the manipulations on the lines being simply replaced by manipulations on the columns. <br />Here is now an applet that will allow you to visualize LU factorizations for matrices of order 4 with real coefficients. <br /> P denotes the pivot permuting matrix.
        </div>
        <!-- /en -->
        <!-- STOP  APPLET-->
        <div>
          <table border="2">
            <tbody>
              <tr>
                <td align="center">
                  <button onclick="nameSpace2.Paint();" type="button">
                    <div lang="fr"> Nouvel exemple</div>
                    <!-- /fr -->
                    <div lang="en">New example</div>
                    <!-- /en -->
                  </button>
                </td>
              </tr>
              <tr>
                <td align="center">
                  <div lang="fr">Matrice A</div>
                  <!-- /fr -->
                  <div lang="en">Matrix A</div>
                  <!-- /en -->
                </td>
              </tr>
              <tr>
                <td align="center">
                  <canvas id="myCanvas1" style="border:1px solid #000000;" width="320" height="80"></canvas>
                </td>
              </tr>
              <tr>
                <td align="center">
                  <div lang="fr">Matrice P</div>
                  <!-- /fr -->
                  <div lang="en">Matrix P</div>
                  <!-- /en -->
                </td>
              </tr>
              <tr>
                <td align="center">
                  <canvas id="myCanvas2" style="border:1px solid #000000;" width="320" height="80"></canvas>
                </td>
              </tr>
              <tr>
                <td align="center">
                  <div lang="fr">Matrice L</div>
                  <!-- /fr -->
                  <div lang="en">Matrix L</div>
                  <!-- /en -->
                </td>
              </tr>
              <tr>
                <td align="center">
                  <canvas id="myCanvas3" style="border:1px solid #000000;" width="320" height="80"></canvas>
                </td>
              </tr>
              <tr>
                <td align="center">
                  <div lang="fr"> Matrice U</div>
                  <!-- /fr -->
                  <div lang="en">Matrix U</div>
                  <!-- /en -->
                </td>
              </tr>
              <tr>
                <td align="center">
                  <canvas id="myCanvas4" style="border:1px solid #000000;" width="320" height="80"></canvas>
                </td>
              </tr>
            </tbody>
          </table>
        </div>
        <script src="js/lu.js"></script>
        <!-- /STOP  APPLET-->
        <div lang="fr">
          <h2> Le coin de Python </h2> Voici un programme calculant une factorisation 'exacte' par la méthode de Crout avec pivotage.
        </div>
        <!-- /fr -->
        <div lang="en">
          <h2> Python's Corner </h2>Here is a program calculating an 'exact' factorization by the method of Crout with pivoting.
        </div>
        <!-- /en -->
        <!-- STOP CODE -->
        <p>
          <object data="python/croutpivot.html" type="text/html" width="100%" height="400" border="3"></object>
        </p>
        <!-- /STOP  CODE-->
        <div lang="fr"> Voici le résultat d'une exécution: </div>
        <!-- /fr -->
        <div lang="en"> Here is the result of an execution: </div>
        <!-- /en -->
        <!-- STOP -->
        <pre>(0,3,9,7,5,9,3)
(4,5,6,7,4,0,9)
(4,5,5,7,2,3,8)
(7,3,1,4,7,0,5)
(4,3,5,0,1,5,8)
(6,2,6,4,1,3,5)
(9,0,3,4,2,2,5)
----------------
(4,0,0,0,0,0,0)
(0,3,0,0,0,0,0)
(4,0,-1,0,0,0,0)
(7,-23/4,31/4,31/6,0,0,0)
(4,-2,5,-7/3,-765/62,0,0)
(6,-11/2,27/2,19/3,-483/31,-11621/255,0)
(9,-45/4,93/4,29/2,-1125/62,-1246/17,51897/11621)
----------------
(1,5/4,3/2,7/4,1,0,9/4)
(0,1,3,7/3,5/3,3,1)
(0,0,1,0,2,-3,1)
(0,0,0,1,-71/62,243/31,-153/62)
(0,0,0,0,1,-2746/765,121/153)
(0,0,0,0,0,1,-2920/11621)
(0,0,0,0,0,0,1)
----------------
(4,5,6,7,4,0,9)
(0,3,9,7,5,9,3)
(4,5,5,7,2,3,8)
(7,3,1,4,7,0,5)
(4,3,5,0,1,5,8)
(6,2,6,4,1,3,5)
(9,0,3,4,2,2,5)
----------------
(0,1,0,0,0,0,0)
(1,0,0,0,0,0,0)
(0,0,1,0,0,0,0)
(0,0,0,1,0,0,0)
(0,0,0,0,1,0,0)
(0,0,0,0,0,1,0)
(0,0,0,0,0,0,1)
----------------
(0,3,9,7,5,9,3)
(4,5,6,7,4,0,9)
(4,5,5,7,2,3,8)
(7,3,1,4,7,0,5)
(4,3,5,0,1,5,8)
(6,2,6,4,1,3,5)
(9,0,3,4,2,2,5)
</pre>
        <!-- /STOP -->
        <div lang="fr"> Voici maintenant un programme utilisant la bibliothèque scipy.linalg: </div>
        <!-- /fr -->
        <div lang="en"> Now here is a program using the scipy.linalg library: </div>
        <!-- /en -->
        <!-- STOP CODE -->
        <p>
          <object data="python/croutlinalg.html" type="text/html" width="100%" height="200" border="3"></object>
        </p>
        <!-- /STOP  CODE-->
        <div lang="fr"> Voici le résultat de l'exécution: </div>
        <!-- /fr -->
        <div lang="en"> Here is the result of the execution: </div>
        <!-- /en -->
        <!-- STOP -->
        <pre>[[ 1.          0.          0.        ]
 [ 0.14285714  1.          0.        ]
 [ 0.57142857  0.5         1.        ]]
[[ 7.          8.          8.        ]
 [ 0.          0.85714286  1.85714286]
 [ 0.          0.          0.5       ]]
[[ 7.  8.  8.]
 [ 1.  2.  3.]
 [ 4.  5.  6.]]
[[ 1.  2.  3.]
 [ 4.  5.  6.]
 [ 7.  8.  8.]]
 </pre>
        <!-- /STOP -->
        <div lang="fr">
          <h2>Le coin de Julia</h2>
          <p> A la différence de Python scipy, dans la décomposition LU Julia ne ramène pas une matrice de permutation mais une permutation. Le produit de P par LU n'a donc aucun sens, il faut programmer 'à la main' une fonction qui permute les lignes.</p>
        </div>
        <!-- /fr -->
        <div lang="en">
          <h2>Julia's corner </h2>
          <p>Unlike Python scipy, in the LU decomposition Julia does not return a permutation matrix but a simple permutation. The product of P by LU therefore makes no sense, you have to program 'by hand' a function that swaps the lines. </p>
        </div>
        <!-- /en -->
        <!-- STOP CODE -->
        <p>
          <object data="julia/LU2.jl.html" type="text/html" width="100%" height="280" border="3"></object>
        </p>
        <!-- /STOP  CODE-->
        <div lang="fr">
          <p>Algorithme de Crout avec Julia 1.6</p>
        </div>
        <!-- /fr -->
        <div lang="en">
          <p>Crout's algorithm with Julia 1.6</p>
        </div>
        <!-- /en -->
        <!-- STOP CODE -->
        <p>
          <object data="julia/lu-crout.jl.html" type="text/html" width="100%" height="400" border="3"></object>
        </p>
        <!-- /STOP  CODE-->
        <div lang="fr">
          <div>
            <ul style=list-style-type:'';>
              <li>
                <input type="button" value="Retour au début de cette page" onclick="go('#beg')" />
              </li>
              <li>
                <input type="button" value="Retour au menu 'Systèmes linéaires'" onclick="go('index.html')" />
              </li>
              <li>
                <input type="button" value="Retour au menu 'Algèbre linéaire'" onclick="go('../index.html')" />
              </li>
              <li>
                <input type="button" value="Retour à l'accueil" onclick="go('../../index.html')" />
              </li>
            </ul>
          </div>
          <!-- /navbar -->
        </div>
        <!-- /fr -->
        <div lang="en">
          <div>
            <ul style=list-style-type:'';>
              <li>
                <input type="button" value="Back to the beginning of this page" onclick="go('#beg')" />
              </li>
              <li>
                <input type="button" value="Back to 'Linear systems'" onclick="go('index.html')" />
              </li>
              <li>
                <input type="button" value="Back to Linear Algebra" onclick="go('../index.html')" />
              </li>
              <li>
                <input type="button" value="Back to home page" onclick="go('../../index.html')" />
              </li>
            </ul>
          </div>
        </div>
        <!-- /en -->
      </div>
      <!-- /content -->
      <div data-role="footer">
        <table cellpadding="10">
          <tr>
            <td>
              <div lang="fr">Création Gilles Dubois</div>
              <div lang="en">Created by Gilles Dubois</div>
            </td>
            <td>
              <div lang="fr">Janvier 2022</div>
              <div lang="en">January 2022</div>
            </td>
            <td>
              <div lang="fr">Version mobile Jquery</div>
              <div lang="en">Mobile Jquery version</div>
            </td>
            <td>
              <a href="https://www.mathjax.org">
                <img title="Powered by MathJax" src="https://www.mathjax.org/badge/badge.gif" border="0" alt="Powered by MathJax" />
              </a>
            </td>
          </tr>
        </table>
      </div>
      <!-- /footer -->
      <ul style=list-style-type:'';>
        <li>
          <div lang="fr">
            <input type="button" value="Auteur" onclick="goext('../../presentation.html')" data-inline="false" />
          </div>
          <div lang="en">
            <input type="button" value="Author" onclick="goext('../../presentation.html')" data-inline="false" />
          </div>
        </li>
        <li>
          <a href="mailto:gilles.paul.dubois@free.fr" data-role="button" rel="external">Mail</a>
        </li>
      </ul>
    </div>
    <!-- /page -->
  </body>
</html>